{% load math_filters %}
<div id="odontograma-clinico-exacto" class="odontograma-clinico-exacto">
    <style>
        .odontograma-clinico-exacto {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            font-family: 'Arial', sans-serif;
            background: #f5f3e8;
            border-radius: 8px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }
        
        .odontograma-clinico-exacto svg {
            width: 100%;
            height: auto;
            background: #f5f3e8;
            border-radius: 5px;
        }
        
        /* Fondo de enc칤as como en la imagen */
        .encia-area {
            fill: #e6c2a6;
            opacity: 0.6;
        }
        
        /* L칤neas de divisi칩n principales */
        .linea-division-principal {
            stroke: #333;
            stroke-width: 2;
            opacity: 0.9;
        }
        
        /* Dientes con superficie oclusal real */
        .diente-real {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .diente-real:hover {
            filter: drop-shadow(0 0 4px rgba(0, 123, 255, 0.7));
        }
        
        .diente-real.selected {
            filter: drop-shadow(0 0 8px rgba(255, 193, 7, 1));
        }
        
        /* Superficie oclusal de los dientes */
        .superficie-dental {
            fill: #ffffff;
            stroke: #333;
            stroke-width: 1;
        }
        
        /* Estados de diagn칩stico */
        .diente-real.sano .superficie-dental { fill: #4caf50; }
        .diente-real.caries .superficie-dental { fill: #f44336; }
        .diente-real.obturada .superficie-dental { fill: #ff9800; }
        .diente-real.corona .superficie-dental { fill: #2196f3; }
        .diente-real.extraida .superficie-dental { 
            fill: #9e9e9e; 
            stroke-dasharray: 2,2;
            opacity: 0.5;
        }
        .diente-real.implante .superficie-dental { fill: #00bcd4; }
        .diente-real.endodoncia .superficie-dental { fill: #e91e63; }
        
        /* Numeraci칩n de dientes */
        .numero-dental {
            font-family: 'Arial', sans-serif;
            font-size: 9px;
            font-weight: bold;
            fill: #333;
            text-anchor: middle;
            dominant-baseline: central;
            pointer-events: none;
        }
        
        /* Etiquetas */
        .etiqueta-principal {
            font-family: 'Arial', sans-serif;
            font-size: 12px;
            font-weight: bold;
            fill: #2d3748;
            text-anchor: middle;
        }
        
        .etiqueta-direccion {
            font-family: 'Arial', sans-serif;
            font-size: 10px;
            font-weight: 600;
            fill: #4a5568;
            text-anchor: middle;
        }
        
        /* Paneles de informaci칩n */
        .panel-lateral {
            fill: #ffffff;
            stroke: #333;
            stroke-width: 1;
        }
        
        .panel-titulo {
            fill: #4a5568;
            stroke: none;
        }
        
        .texto-panel-lateral {
            font-family: 'Arial', sans-serif;
            font-size: 8px;
            fill: #333;
            text-anchor: start;
        }
        
        .texto-titulo-panel {
            font-family: 'Arial', sans-serif;
            font-size: 9px;
            font-weight: bold;
            fill: #fff;
            text-anchor: middle;
        }
        
        /* L칤neas para escribir */
        .linea-escritura {
            stroke: #ccc;
            stroke-width: 0.5;
        }
    </style>
    
    <div class="text-center mb-2">
        <h4 style="color: #2d3748; margin-bottom: 5px; font-weight: 700;">
            游붱 Odontograma Cl칤nico Profesional
        </h4>
        <p style="color: #4a5568; font-size: 0.85rem; margin-bottom: 3px;">
            Formato est치ndar de historia cl칤nica dental
        </p>
    </div>
    
    <svg viewBox="0 0 900 650" xmlns="http://www.w3.org/2000/svg">
        <!-- Fondo principal -->
        <rect width="900" height="650" fill="#f5f3e8"/>
        
        <!-- ==================== PANELES LATERALES COMO EN LA IMAGEN ==================== -->
        
        <!-- Panel SUPERIORES DERECHOS -->
        <rect x="15" y="80" width="100" height="160" class="panel-lateral"/>
        <rect x="15" y="80" width="100" height="18" class="panel-titulo"/>
        <text x="65" y="92" class="texto-titulo-panel">Superiores Derechos</text>
        
        <!-- L칤neas y n칰meros del panel superior derecho -->
        <line x1="18" y1="108" x2="112" y2="108" class="linea-escritura"/>
        <text x="20" y="115" class="texto-panel-lateral">18</text>
        <line x1="18" y1="125" x2="112" y2="125" class="linea-escritura"/>
        <text x="20" y="132" class="texto-panel-lateral">17</text>
        <line x1="18" y1="142" x2="112" y2="142" class="linea-escritura"/>
        <text x="20" y="149" class="texto-panel-lateral">16</text>
        <line x1="18" y1="159" x2="112" y2="159" class="linea-escritura"/>
        <text x="20" y="166" class="texto-panel-lateral">15</text>
        <line x1="18" y1="176" x2="112" y2="176" class="linea-escritura"/>
        <text x="20" y="183" class="texto-panel-lateral">14</text>
        <line x1="18" y1="193" x2="112" y2="193" class="linea-escritura"/>
        <text x="20" y="200" class="texto-panel-lateral">13</text>
        <line x1="18" y1="210" x2="112" y2="210" class="linea-escritura"/>
        <text x="20" y="217" class="texto-panel-lateral">12</text>
        <line x1="18" y1="227" x2="112" y2="227" class="linea-escritura"/>
        <text x="20" y="234" class="texto-panel-lateral">11</text>
        
        <!-- Panel SUPERIORES IZQUIERDOS -->
        <rect x="785" y="80" width="100" height="160" class="panel-lateral"/>
        <rect x="785" y="80" width="100" height="18" class="panel-titulo"/>
        <text x="835" y="92" class="texto-titulo-panel">Superiores Izquierdos</text>
        
        <line x1="788" y1="108" x2="882" y2="108" class="linea-escritura"/>
        <text x="790" y="115" class="texto-panel-lateral">21</text>
        <line x1="788" y1="125" x2="882" y2="125" class="linea-escritura"/>
        <text x="790" y="132" class="texto-panel-lateral">22</text>
        <line x1="788" y1="142" x2="882" y2="142" class="linea-escritura"/>
        <text x="790" y="149" class="texto-panel-lateral">23</text>
        <line x1="788" y1="159" x2="882" y2="159" class="linea-escritura"/>
        <text x="790" y="166" class="texto-panel-lateral">24</text>
        <line x1="788" y1="176" x2="882" y2="176" class="linea-escritura"/>
        <text x="790" y="183" class="texto-panel-lateral">25</text>
        <line x1="788" y1="193" x2="882" y2="193" class="linea-escritura"/>
        <text x="790" y="200" class="texto-panel-lateral">26</text>
        <line x1="788" y1="210" x2="882" y2="210" class="linea-escritura"/>
        <text x="790" y="217" class="texto-panel-lateral">27</text>
        <line x1="788" y1="227" x2="882" y2="227" class="linea-escritura"/>
        <text x="790" y="234" class="texto-panel-lateral">28</text>
        
        <!-- Panel INFERIORES DERECHOS -->
        <rect x="15" y="410" width="100" height="160" class="panel-lateral"/>
        <rect x="15" y="410" width="100" height="18" class="panel-titulo"/>
        <text x="65" y="422" class="texto-titulo-panel">Inferiores Derechos</text>
        
        <line x1="18" y1="438" x2="112" y2="438" class="linea-escritura"/>
        <text x="20" y="445" class="texto-panel-lateral">48</text>
        <line x1="18" y1="455" x2="112" y2="455" class="linea-escritura"/>
        <text x="20" y="462" class="texto-panel-lateral">47</text>
        <line x1="18" y1="472" x2="112" y2="472" class="linea-escritura"/>
        <text x="20" y="479" class="texto-panel-lateral">46</text>
        <line x1="18" y1="489" x2="112" y2="489" class="linea-escritura"/>
        <text x="20" y="496" class="texto-panel-lateral">45</text>
        <line x1="18" y1="506" x2="112" y2="506" class="linea-escritura"/>
        <text x="20" y="513" class="texto-panel-lateral">44</text>
        <line x1="18" y1="523" x2="112" y2="523" class="linea-escritura"/>
        <text x="20" y="530" class="texto-panel-lateral">43</text>
        <line x1="18" y1="540" x2="112" y2="540" class="linea-escritura"/>
        <text x="20" y="547" class="texto-panel-lateral">42</text>
        <line x1="18" y1="557" x2="112" y2="557" class="linea-escritura"/>
        <text x="20" y="564" class="texto-panel-lateral">41</text>
        
        <!-- Panel INFERIORES IZQUIERDOS -->
        <rect x="785" y="410" width="100" height="160" class="panel-lateral"/>
        <rect x="785" y="410" width="100" height="18" class="panel-titulo"/>
        <text x="835" y="422" class="texto-titulo-panel">Inferiores Izquierdos</text>
        
        <line x1="788" y1="438" x2="882" y2="438" class="linea-escritura"/>
        <text x="790" y="445" class="texto-panel-lateral">31</text>
        <line x1="788" y1="455" x2="882" y2="455" class="linea-escritura"/>
        <text x="790" y="462" class="texto-panel-lateral">32</text>
        <line x1="788" y1="472" x2="882" y2="472" class="linea-escritura"/>
        <text x="790" y="479" class="texto-panel-lateral">33</text>
        <line x1="788" y1="489" x2="882" y2="489" class="linea-escritura"/>
        <text x="790" y="496" class="texto-panel-lateral">34</text>
        <line x1="788" y1="506" x2="882" y2="506" class="linea-escritura"/>
        <text x="790" y="513" class="texto-panel-lateral">35</text>
        <line x1="788" y1="523" x2="882" y2="523" class="linea-escritura"/>
        <text x="790" y="530" class="texto-panel-lateral">36</text>
        <line x1="788" y1="540" x2="882" y2="540" class="linea-escritura"/>
        <text x="790" y="547" class="texto-panel-lateral">37</text>
        <line x1="788" y1="557" x2="882" y2="557" class="linea-escritura"/>
        <text x="790" y="564" class="texto-panel-lateral">38</text>
        
        <!-- ==================== 츼REA CENTRAL - VISTA OCLUSAL COMO EN LA IMAGEN ==================== -->
        
        <!-- Fondo de enc칤as superior (color marr칩n claro) -->
        <ellipse cx="450" cy="220" rx="280" ry="80" class="encia-area"/>
        
        <!-- Fondo de enc칤as inferior -->
        <ellipse cx="450" cy="430" rx="280" ry="80" class="encia-area"/>
        
        <!-- L칤neas de divisi칩n de cuadrantes (cruz central) -->
        <line x1="450" y1="140" x2="450" y2="510" class="linea-division-principal"/>
        <line x1="170" y1="325" x2="730" y2="325" class="linea-division-principal"/>
        
        <!-- Etiquetas direccionales -->
        <text x="450" y="130" class="etiqueta-principal">Superior</text>
        <text x="450" y="530" class="etiqueta-principal">Inferior</text>
        <text x="140" y="330" class="etiqueta-direccion">Derecha Paciente</text>
        <text x="760" y="330" class="etiqueta-direccion">Izquierda Paciente</text>
        
        <!-- ==================== DIENTES SUPERIORES COMO EN LA IMAGEN ==================== -->
        
        <!-- CUADRANTE SUPERIOR DERECHO (18-11) -->
        
        <!-- Diente 18 - Molar -->
        <g class="diente-real" id="diente-18">
            <ellipse cx="180" cy="200" rx="18" ry="12" class="superficie-dental"/>
            <line x1="168" y1="200" x2="192" y2="200" stroke="#ddd" stroke-width="0.5"/>
            <line x1="180" y1="190" x2="180" y2="210" stroke="#ddd" stroke-width="0.5"/>
            <text x="180" y="200" class="numero-dental">18</text>
        </g>
        
        <!-- Diente 17 - Molar -->
        <g class="diente-real" id="diente-17">
            <ellipse cx="220" cy="190" rx="17" ry="11" class="superficie-dental"/>
            <line x1="209" y1="190" x2="231" y2="190" stroke="#ddd" stroke-width="0.5"/>
            <line x1="220" y1="181" x2="220" y2="199" stroke="#ddd" stroke-width="0.5"/>
            <text x="220" y="190" class="numero-dental">17</text>
        </g>
        
        <!-- Diente 16 - Molar -->
        <g class="diente-real" id="diente-16">
            <ellipse cx="260" cy="180" rx="16" ry="10" class="superficie-dental"/>
            <line x1="249" y1="180" x2="271" y2="180" stroke="#ddd" stroke-width="0.5"/>
            <line x1="260" y1="172" x2="260" y2="188" stroke="#ddd" stroke-width="0.5"/>
            <text x="260" y="180" class="numero-dental">16</text>
        </g>
        
        <!-- Diente 15 - Premolar -->
        <g class="diente-real" id="diente-15">
            <ellipse cx="300" cy="175" rx="12" ry="8" class="superficie-dental"/>
            <line x1="294" y1="175" x2="306" y2="175" stroke="#ddd" stroke-width="0.5"/>
            <text x="300" y="175" class="numero-dental">15</text>
        </g>
        
        <!-- Diente 14 - Premolar -->
        <g class="diente-real" id="diente-14">
            <ellipse cx="330" cy="170" rx="11" ry="7" class="superficie-dental"/>
            <line x1="325" y1="170" x2="335" y2="170" stroke="#ddd" stroke-width="0.5"/>
            <text x="330" y="170" class="numero-dental">14</text>
        </g>
        
        <!-- Diente 13 - Canino -->
        <g class="diente-real" id="diente-13">
            <ellipse cx="365" cy="168" rx="8" ry="6" class="superficie-dental"/>
            <text x="365" y="168" class="numero-dental">13</text>
        </g>
        
        <!-- Diente 12 - Incisivo Lateral -->
        <g class="diente-real" id="diente-12">
            <ellipse cx="395" cy="165" rx="7" ry="5" class="superficie-dental"/>
            <text x="395" y="165" class="numero-dental">12</text>
        </g>
        
        <!-- Diente 11 - Incisivo Central -->
        <g class="diente-real" id="diente-11">
            <ellipse cx="425" cy="165" rx="8" ry="6" class="superficie-dental"/>
            <text x="425" y="165" class="numero-dental">11</text>
        </g>
        
        <!-- CUADRANTE SUPERIOR IZQUIERDO (21-28) -->
        
        <!-- Diente 21 - Incisivo Central -->
        <g class="diente-real" id="diente-21">
            <ellipse cx="475" cy="165" rx="8" ry="6" class="superficie-dental"/>
            <text x="475" y="165" class="numero-dental">21</text>
        </g>
        
        <!-- Diente 22 - Incisivo Lateral -->
        <g class="diente-real" id="diente-22">
            <ellipse cx="505" cy="165" rx="7" ry="5" class="superficie-dental"/>
            <text x="505" y="165" class="numero-dental">22</text>
        </g>
        
        <!-- Diente 23 - Canino -->
        <g class="diente-real" id="diente-23">
            <ellipse cx="535" cy="168" rx="8" ry="6" class="superficie-dental"/>
            <text x="535" y="168" class="numero-dental">23</text>
        </g>
        
        <!-- Diente 24 - Premolar -->
        <g class="diente-real" id="diente-24">
            <ellipse cx="570" cy="170" rx="11" ry="7" class="superficie-dental"/>
            <line x1="565" y1="170" x2="575" y2="170" stroke="#ddd" stroke-width="0.5"/>
            <text x="570" y="170" class="numero-dental">24</text>
        </g>
        
        <!-- Diente 25 - Premolar -->
        <g class="diente-real" id="diente-25">
            <ellipse cx="600" cy="175" rx="12" ry="8" class="superficie-dental"/>
            <line x1="594" y1="175" x2="606" y2="175" stroke="#ddd" stroke-width="0.5"/>
            <text x="600" y="175" class="numero-dental">25</text>
        </g>
        
        <!-- Diente 26 - Molar -->
        <g class="diente-real" id="diente-26">
            <ellipse cx="640" cy="180" rx="16" ry="10" class="superficie-dental"/>
            <line x1="629" y1="180" x2="651" y2="180" stroke="#ddd" stroke-width="0.5"/>
            <line x1="640" y1="172" x2="640" y2="188" stroke="#ddd" stroke-width="0.5"/>
            <text x="640" y="180" class="numero-dental">26</text>
        </g>
        
        <!-- Diente 27 - Molar -->
        <g class="diente-real" id="diente-27">
            <ellipse cx="680" cy="190" rx="17" ry="11" class="superficie-dental"/>
            <line x1="669" y1="190" x2="691" y2="190" stroke="#ddd" stroke-width="0.5"/>
            <line x1="680" y1="181" x2="680" y2="199" stroke="#ddd" stroke-width="0.5"/>
            <text x="680" y="190" class="numero-dental">27</text>
        </g>
        
        <!-- Diente 28 - Molar -->
        <g class="diente-real" id="diente-28">
            <ellipse cx="720" cy="200" rx="18" ry="12" class="superficie-dental"/>
            <line x1="708" y1="200" x2="732" y2="200" stroke="#ddd" stroke-width="0.5"/>
            <line x1="720" y1="190" x2="720" y2="210" stroke="#ddd" stroke-width="0.5"/>
            <text x="720" y="200" class="numero-dental">28</text>
        </g>
        
        <!-- ==================== DIENTES INFERIORES COMO EN LA IMAGEN ==================== -->
        
        <!-- CUADRANTE INFERIOR DERECHO (48-41) -->
        
        <!-- Diente 48 - Molar -->
        <g class="diente-real" id="diente-48">
            <ellipse cx="180" cy="450" rx="18" ry="12" class="superficie-dental"/>
            <line x1="168" y1="450" x2="192" y2="450" stroke="#ddd" stroke-width="0.5"/>
            <line x1="180" y1="440" x2="180" y2="460" stroke="#ddd" stroke-width="0.5"/>
            <text x="180" y="450" class="numero-dental">48</text>
        </g>
        
        <!-- Diente 47 - Molar -->
        <g class="diente-real" id="diente-47">
            <ellipse cx="220" cy="460" rx="17" ry="11" class="superficie-dental"/>
            <line x1="209" y1="460" x2="231" y2="460" stroke="#ddd" stroke-width="0.5"/>
            <line x1="220" y1="451" x2="220" y2="469" stroke="#ddd" stroke-width="0.5"/>
            <text x="220" y="460" class="numero-dental">47</text>
        </g>
        
        <!-- Diente 46 - Molar -->
        <g class="diente-real" id="diente-46">
            <ellipse cx="260" cy="470" rx="16" ry="10" class="superficie-dental"/>
            <line x1="249" y1="470" x2="271" y2="470" stroke="#ddd" stroke-width="0.5"/>
            <line x1="260" y1="462" x2="260" y2="478" stroke="#ddd" stroke-width="0.5"/>
            <text x="260" y="470" class="numero-dental">46</text>
        </g>
        
        <!-- Diente 45 - Premolar -->
        <g class="diente-real" id="diente-45">
            <ellipse cx="300" cy="475" rx="12" ry="8" class="superficie-dental"/>
            <line x1="294" y1="475" x2="306" y2="475" stroke="#ddd" stroke-width="0.5"/>
            <text x="300" y="475" class="numero-dental">45</text>
        </g>
        
        <!-- Diente 44 - Premolar -->
        <g class="diente-real" id="diente-44">
            <ellipse cx="330" cy="480" rx="11" ry="7" class="superficie-dental"/>
            <line x1="325" y1="480" x2="335" y2="480" stroke="#ddd" stroke-width="0.5"/>
            <text x="330" y="480" class="numero-dental">44</text>
        </g>
        
        <!-- Diente 43 - Canino -->
        <g class="diente-real" id="diente-43">
            <ellipse cx="365" cy="482" rx="8" ry="6" class="superficie-dental"/>
            <text x="365" y="482" class="numero-dental">43</text>
        </g>
        
        <!-- Diente 42 - Incisivo Lateral -->
        <g class="diente-real" id="diente-42">
            <ellipse cx="395" cy="485" rx="7" ry="5" class="superficie-dental"/>
            <text x="395" y="485" class="numero-dental">42</text>
        </g>
        
        <!-- Diente 41 - Incisivo Central -->
        <g class="diente-real" id="diente-41">
            <ellipse cx="425" cy="485" rx="8" ry="6" class="superficie-dental"/>
            <text x="425" y="485" class="numero-dental">41</text>
        </g>
        
        <!-- CUADRANTE INFERIOR IZQUIERDO (31-38) -->
        
        <!-- Diente 31 - Incisivo Central -->
        <g class="diente-real" id="diente-31">
            <ellipse cx="475" cy="485" rx="8" ry="6" class="superficie-dental"/>
            <text x="475" y="485" class="numero-dental">31</text>
        </g>
        
        <!-- Diente 32 - Incisivo Lateral -->
        <g class="diente-real" id="diente-32">
            <ellipse cx="505" cy="485" rx="7" ry="5" class="superficie-dental"/>
            <text x="505" y="485" class="numero-dental">32</text>
        </g>
        
        <!-- Diente 33 - Canino -->
        <g class="diente-real" id="diente-33">
            <ellipse cx="535" cy="482" rx="8" ry="6" class="superficie-dental"/>
            <text x="535" y="482" class="numero-dental">33</text>
        </g>
        
        <!-- Diente 34 - Premolar -->
        <g class="diente-real" id="diente-34">
            <ellipse cx="570" cy="480" rx="11" ry="7" class="superficie-dental"/>
            <line x1="565" y1="480" x2="575" y2="480" stroke="#ddd" stroke-width="0.5"/>
            <text x="570" y="480" class="numero-dental">34</text>
        </g>
        
        <!-- Diente 35 - Premolar -->
        <g class="diente-real" id="diente-35">
            <ellipse cx="600" cy="475" rx="12" ry="8" class="superficie-dental"/>
            <line x1="594" y1="475" x2="606" y2="475" stroke="#ddd" stroke-width="0.5"/>
            <text x="600" y="475" class="numero-dental">35</text>
        </g>
        
        <!-- Diente 36 - Molar -->
        <g class="diente-real" id="diente-36">
            <ellipse cx="640" cy="470" rx="16" ry="10" class="superficie-dental"/>
            <line x1="629" y1="470" x2="651" y2="470" stroke="#ddd" stroke-width="0.5"/>
            <line x1="640" y1="462" x2="640" y2="478" stroke="#ddd" stroke-width="0.5"/>
            <text x="640" y="470" class="numero-dental">36</text>
        </g>
        
        <!-- Diente 37 - Molar -->
        <g class="diente-real" id="diente-37">
            <ellipse cx="680" cy="460" rx="17" ry="11" class="superficie-dental"/>
            <line x1="669" y1="460" x2="691" y2="460" stroke="#ddd" stroke-width="0.5"/>
            <line x1="680" y1="451" x2="680" y2="469" stroke="#ddd" stroke-width="0.5"/>
            <text x="680" y="460" class="numero-dental">37</text>
        </g>
        
        <!-- Diente 38 - Molar -->
        <g class="diente-real" id="diente-38">
            <ellipse cx="720" cy="450" rx="18" ry="12" class="superficie-dental"/>
            <line x1="708" y1="450" x2="732" y2="450" stroke="#ddd" stroke-width="0.5"/>
            <line x1="720" y1="440" x2="720" y2="460" stroke="#ddd" stroke-width="0.5"/>
            <text x="720" y="450" class="numero-dental">38</text>
        </g>
        
    </svg>
</div>

<script>
(function() {
    'use strict';
    
    function log(mensaje) {
        console.log(`[ODONTOGRAMA CL칈NICO EXACTO] ${mensaje}`);
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        log('Iniciando odontograma cl칤nico formato exacto');
        
        const dientes = document.querySelectorAll('.diente-real');
        log(`Configurando ${dientes.length} dientes con formato cl칤nico exacto`);
        
        dientes.forEach(function(diente, index) {
            const dienteId = diente.id;
            const numeroFDI = dienteId.replace('diente-', '');
            const cuadrante = Math.floor(numeroFDI / 10);
            const posicion = numeroFDI % 10;
            
            // Determinar el tipo de diente
            let tipoDiente = '';
            if (posicion === 1 || posicion === 2) {
                tipoDiente = 'Incisivo';
            } else if (posicion === 3) {
                tipoDiente = 'Canino';
            } else if (posicion === 4 || posicion === 5) {
                tipoDiente = 'Premolar';
            } else if (posicion === 6 || posicion === 7 || posicion === 8) {
                tipoDiente = 'Molar';
            }
            
            diente.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                log(`Diente seleccionado: ${numeroFDI} (${tipoDiente}, Cuadrante ${cuadrante})`);
                
                // Remover selecci칩n anterior
                document.querySelectorAll('.diente-real').forEach(d => {
                    d.classList.remove('selected');
                });
                
                // Seleccionar diente actual
                diente.classList.add('selected');
                
                // Disparar evento personalizado
                const eventoSeleccion = new CustomEvent('dienteExactoSeleccionado', {
                    detail: {
                        numeroFDI: numeroFDI,
                        cuadrante: cuadrante,
                        posicion: posicion,
                        tipoDiente: tipoDiente,
                        elemento: diente
                    }
                });
                
                document.dispatchEvent(eventoSeleccion);
            });
            
            diente.addEventListener('mouseenter', function() {
                log(`Hover en diente FDI ${numeroFDI} (${tipoDiente})`);
            });
        });
        
        log('Odontograma cl칤nico exacto inicializado correctamente');
    });
    
    // Funci칩n global para aplicar diagn칩sticos
    window.aplicarDiagnosticoExacto = function(numeroFDI, diagnostico) {
        const diente = document.getElementById(`diente-${numeroFDI}`);
        if (diente) {
            // Remover diagn칩sticos anteriores
            diente.classList.remove('sano', 'caries', 'obturada', 'corona', 'extraida', 'implante', 'endodoncia');
            
            // Aplicar nuevo diagn칩stico
            if (diagnostico) {
                diente.classList.add(diagnostico);
                log(`Diagn칩stico aplicado: Diente ${numeroFDI} - ${diagnostico}`);
            }
        }
    };
    
    // Funci칩n global para limpiar selecciones
    window.limpiarSeleccionExacto = function() {
        document.querySelectorAll('.diente-real').forEach(diente => {
            diente.classList.remove('selected', 'sano', 'caries', 'obturada', 'corona', 'extraida', 'implante', 'endodoncia');
        });
        log('Selecci칩n y diagn칩sticos limpiados');
    };
    
})();
</script>