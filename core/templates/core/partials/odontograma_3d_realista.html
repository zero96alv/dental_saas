{% load math_filters %}
<div id="odontograma-3d-realista" class="odontograma-3d-realista">
    <style>
        .odontograma-3d-realista {
            max-width: 1400px;
            margin: 0 auto;
            padding: 25px;
            font-family: 'Arial', sans-serif;
            background: #f5f2eb;
            border-radius: 20px;
            box-shadow: 0 8px 35px rgba(0,0,0,0.12);
        }
        
        .odontograma-3d-realista svg {
            width: 100%;
            height: auto;
            background: #f5f2eb;
            border-radius: 15px;
        }
        
        /* Enc铆as con gradientes ultra realistas */
        .encia-superior-3d {
            fill: url(#gradientEnciaSuperior3D);
            opacity: 0.9;
            filter: drop-shadow(0 2px 6px rgba(0,0,0,0.1));
        }
        
        .encia-inferior-3d {
            fill: url(#gradientEnciaInferior3D);
            opacity: 0.9;
            filter: drop-shadow(0 2px 6px rgba(0,0,0,0.1));
        }
        
        /* L铆neas de divisi贸n profesionales */
        .linea-central-3d {
            stroke: #2c3e50;
            stroke-width: 3;
            opacity: 0.8;
        }
        
        .linea-horizontal-3d {
            stroke: #2c3e50;
            stroke-width: 2.5;
            opacity: 0.7;
        }
        
        /* Dientes 3D base con efectos realistas */
        .diente-3d {
            cursor: pointer;
            transition: all 0.3s ease;
            filter: drop-shadow(0 2px 6px rgba(0,0,0,0.15));
        }
        
        .diente-3d:hover {
            filter: drop-shadow(0 0 12px rgba(52, 152, 219, 0.9)) drop-shadow(0 2px 6px rgba(0,0,0,0.15));
            transform: scale(1.05);
        }
        
        .diente-3d.selected {
            filter: drop-shadow(0 0 20px rgba(241, 196, 15, 1)) drop-shadow(0 2px 6px rgba(0,0,0,0.15));
            transform: scale(1.07);
        }
        
        /* Superficies oclusales con gradientes 3D */
        .superficie-3d {
            fill: url(#gradientDiente3D);
            stroke: #8b7355;
            stroke-width: 1.5;
        }
        
        /* INCISIVOS CENTRALES - Rectangulares con borde incisal */
        .incisivo-central-superior-3d .superficie-3d {
            fill: url(#gradientIncisivoCentral3D);
        }
        
        .incisivo-central-inferior-3d .superficie-3d {
            fill: url(#gradientIncisivoCentralInf3D);
        }
        
        /* INCISIVOS LATERALES - M谩s estrechos */
        .incisivo-lateral-superior-3d .superficie-3d {
            fill: url(#gradientIncisivoLateral3D);
        }
        
        .incisivo-lateral-inferior-3d .superficie-3d {
            fill: url(#gradientIncisivoLateralInf3D);
        }
        
        /* CANINOS - Triangulares puntiagudos */
        .canino-superior-3d .superficie-3d {
            fill: url(#gradientCanino3D);
        }
        
        .canino-inferior-3d .superficie-3d {
            fill: url(#gradientCaninoInf3D);
        }
        
        /* PREMOLARES - Ovalados con c煤spides */
        .premolar-superior-3d .superficie-3d {
            fill: url(#gradientPremolar3D);
        }
        
        .premolar-inferior-3d .superficie-3d {
            fill: url(#gradientPremolarInf3D);
        }
        
        /* MOLARES - Cuadrados con m煤ltiples c煤spides */
        .molar-superior-3d .superficie-3d {
            fill: url(#gradientMolar3D);
        }
        
        .molar-inferior-3d .superficie-3d {
            fill: url(#gradientMolarInf3D);
        }
        
        /* L铆neas anat贸micas 3D */
        .cuspide-3d {
            stroke: #a68b5b;
            stroke-width: 1.2;
            opacity: 0.8;
            fill: none;
        }
        
        .fisura-central-3d {
            stroke: #8b7355;
            stroke-width: 1.5;
            opacity: 0.9;
            fill: none;
        }
        
        .fisura-secundaria-3d {
            stroke: #9d8660;
            stroke-width: 0.8;
            opacity: 0.7;
            fill: none;
        }
        
        /* Estados de diagn贸stico con gradientes */
        .diente-3d.sano .superficie-3d { fill: url(#gradientSano3D); }
        .diente-3d.caries .superficie-3d { fill: url(#gradientCaries3D); }
        .diente-3d.obturada .superficie-3d { fill: url(#gradientObturada3D); }
        .diente-3d.corona .superficie-3d { fill: url(#gradientCorona3D); }
        .diente-3d.extraida .superficie-3d { 
            fill: url(#gradientExtraida3D); 
            stroke-dasharray: 5,3;
            opacity: 0.4;
        }
        .diente-3d.implante .superficie-3d { fill: url(#gradientImplante3D); }
        .diente-3d.endodoncia .superficie-3d { fill: url(#gradientEndodoncia3D); }
        
        /* Numeraci贸n 3D */
        .numero-3d {
            font-family: 'Arial', sans-serif;
            font-size: 12px;
            font-weight: bold;
            fill: #2c3e50;
            text-anchor: middle;
            dominant-baseline: central;
            pointer-events: none;
            filter: drop-shadow(0 1px 1px rgba(255,255,255,0.8));
        }
        
        /* Etiquetas profesionales */
        .etiqueta-3d {
            font-family: 'Arial', sans-serif;
            font-size: 18px;
            font-weight: bold;
            fill: #2c3e50;
            text-anchor: middle;
            filter: drop-shadow(0 1px 2px rgba(255,255,255,0.5));
        }
        
        .etiqueta-lateral-3d {
            font-family: 'Arial', sans-serif;
            font-size: 14px;
            font-weight: 600;
            fill: #34495e;
            text-anchor: middle;
            filter: drop-shadow(0 1px 1px rgba(255,255,255,0.3));
        }
    </style>
    
    <div class="text-center mb-4">
        <h4 style="color: #2c3e50; margin-bottom: 10px; font-weight: 800; text-shadow: 0 1px 2px rgba(255,255,255,0.5);">
            Ψ Odontograma 3D Ultra Realista
        </h4>
        <p style="color: #34495e; font-size: 1rem; text-shadow: 0 1px 1px rgba(255,255,255,0.3);">
            Vista oclusal anat贸mica con efectos 3D y proporciones reales
        </p>
    </div>
    
    <svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
        <!-- Definir todos los gradientes 3D realistas -->
        <defs>
            <!-- Gradientes para enc铆as -->
            <radialGradient id="gradientEnciaSuperior3D" cx="50%" cy="20%" r="80%">
                <stop offset="0%" style="stop-color:#f2d4c1;stop-opacity:1" />
                <stop offset="30%" style="stop-color:#e8c2a9;stop-opacity:1" />
                <stop offset="60%" style="stop-color:#d4a574;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#b8935f;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientEnciaInferior3D" cx="50%" cy="80%" r="80%">
                <stop offset="0%" style="stop-color:#f2d4c1;stop-opacity:1" />
                <stop offset="30%" style="stop-color:#e8c2a9;stop-opacity:1" />
                <stop offset="60%" style="stop-color:#d4a574;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#b8935f;stop-opacity:1" />
            </radialGradient>
            
            <!-- Gradientes para dientes base -->
            <radialGradient id="gradientDiente3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#faf8f4;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f5f1ea;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e8ddd0;stop-opacity:1" />
            </radialGradient>
            
            <!-- Gradientes espec铆ficos por tipo de diente -->
            <radialGradient id="gradientIncisivoCentral3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#fcfaf7;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f7f3ec;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#eadfd2;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientIncisivoCentralInf3D" cx="30%" cy="70%" r="70%">
                <stop offset="0%" style="stop-color:#fbf9f6;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f6f2eb;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e9ded1;stop-opacity:1" />
            </radialGradient>
            
            <radialGradient id="gradientIncisivoLateral3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#fbf9f5;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f6f2ea;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e9ddd0;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientIncisivoLateralInf3D" cx="30%" cy="70%" r="70%">
                <stop offset="0%" style="stop-color:#faf8f4;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f5f1e9;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e8dccf;stop-opacity:1" />
            </radialGradient>
            
            <radialGradient id="gradientCanino3D" cx="50%" cy="20%" r="80%">
                <stop offset="0%" style="stop-color:#fcfaf6;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f7f3eb;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#eadfd1;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientCaninoInf3D" cx="50%" cy="80%" r="80%">
                <stop offset="0%" style="stop-color:#fbf9f5;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f6f2ea;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e9ded0;stop-opacity:1" />
            </radialGradient>
            
            <radialGradient id="gradientPremolar3D" cx="40%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#faf8f3;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f5f1e8;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e8dccf;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientPremolarInf3D" cx="40%" cy="70%" r="70%">
                <stop offset="0%" style="stop-color:#f9f7f2;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f4f0e7;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e7dbce;stop-opacity:1" />
            </radialGradient>
            
            <radialGradient id="gradientMolar3D" cx="40%" cy="40%" r="70%">
                <stop offset="0%" style="stop-color:#f9f6f1;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f3efe6;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e6dacc;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientMolarInf3D" cx="40%" cy="60%" r="70%">
                <stop offset="0%" style="stop-color:#f8f5f0;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#f2eee5;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e5d9cb;stop-opacity:1" />
            </radialGradient>
            
            <!-- Gradientes para estados de diagn贸stico -->
            <radialGradient id="gradientSano3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#5dce7a;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#27ae60;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientCaries3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e74c3c;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientObturada3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#ffcd3c;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#f39c12;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientCorona3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#5dade2;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3498db;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientExtraida3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#a6a6a6;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#7f8c8d;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientImplante3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#58d8c9;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#1abc9c;stop-opacity:1" />
            </radialGradient>
            <radialGradient id="gradientEndodoncia3D" cx="30%" cy="30%" r="70%">
                <stop offset="0%" style="stop-color:#ff5ac4;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e91e63;stop-opacity:1" />
            </radialGradient>
        </defs>
        
        <!-- Fondo -->
        <rect width="1200" height="800" fill="#f5f2eb"/>
        
        <!-- ==================== ENCAS 3D REALISTAS ==================== -->
        
        <!-- Enc铆a superior - Arcada realista m谩s grande -->
        <path d="M 120 220 Q 150 140 260 120 Q 380 105 600 105 Q 820 105 940 120 Q 1050 140 1080 220 Q 1070 300 1000 325 Q 870 350 600 350 Q 330 350 200 325 Q 130 300 120 220 Z" class="encia-superior-3d"/>
        
        <!-- Enc铆a inferior - Arcada realista m谩s peque帽a (reflejo invertido) -->
        <path d="M 180 580 Q 200 500 280 475 Q 400 450 600 450 Q 800 450 920 475 Q 1000 500 1020 580 Q 1000 660 920 680 Q 800 695 600 695 Q 400 695 280 680 Q 200 660 180 580 Z" class="encia-inferior-3d"/>
        
        <!-- L铆neas de divisi贸n -->
        <line x1="600" y1="70" x2="600" y2="730" class="linea-central-3d"/>
        <line x1="80" y1="400" x2="1120" y2="400" class="linea-horizontal-3d"/>
        
        <!-- Etiquetas -->
        <text x="600" y="50" class="etiqueta-3d">Superior</text>
        <text x="600" y="770" class="etiqueta-3d">Inferior</text>
        <text x="100" y="405" class="etiqueta-lateral-3d">Derecha</text>
        <text x="1100" y="405" class="etiqueta-lateral-3d">Izquierda</text>
        <text x="100" y="425" class="etiqueta-lateral-3d">Paciente</text>
        <text x="1100" y="425" class="etiqueta-lateral-3d">Paciente</text>
        
        <!-- ==================== DIENTES SUPERIORES 3D ==================== -->
        
        <!-- CUADRANTE SUPERIOR DERECHO (18-11) -->
        
        <!-- Diente 18 - Tercer Molar Superior -->
        <g class="diente-3d molar-superior-3d" id="diente-18">
            <path d="M 140 200 Q 150 180 170 180 Q 190 180 200 200 Q 200 220 190 240 Q 170 245 150 240 Q 140 220 140 200 Z" class="superficie-3d"/>
            <path d="M 148 190 Q 155 185 163 190 Q 170 185 178 190 Q 185 185 192 190" class="cuspide-3d"/>
            <path d="M 148 210 Q 155 205 163 210 Q 170 205 178 210 Q 185 205 192 210" class="cuspide-3d"/>
            <path d="M 148 230 Q 155 225 163 230 Q 170 225 178 230 Q 185 225 192 230" class="cuspide-3d"/>
            <line x1="155" y1="185" x2="155" y2="235" class="fisura-central-3d"/>
            <line x1="170" y1="185" x2="170" y2="235" class="fisura-central-3d"/>
            <line x1="185" y1="185" x2="185" y2="235" class="fisura-central-3d"/>
            <line x1="150" y1="200" x2="190" y2="200" class="fisura-secundaria-3d"/>
            <line x1="150" y1="220" x2="190" y2="220" class="fisura-secundaria-3d"/>
            <text x="170" y="215" class="numero-3d">18</text>
        </g>
        
        <!-- Diente 17 - Segundo Molar Superior -->
        <g class="diente-3d molar-superior-3d" id="diente-17">
            <path d="M 215 190 Q 225 170 245 170 Q 265 170 275 190 Q 275 210 265 230 Q 245 235 225 230 Q 215 210 215 190 Z" class="superficie-3d"/>
            <path d="M 223 180 Q 230 175 238 180 Q 245 175 253 180 Q 260 175 267 180" class="cuspide-3d"/>
            <path d="M 223 200 Q 230 195 238 200 Q 245 195 253 200 Q 260 195 267 200" class="cuspide-3d"/>
            <path d="M 223 220 Q 230 215 238 220 Q 245 215 253 220 Q 260 215 267 220" class="cuspide-3d"/>
            <line x1="230" y1="175" x2="230" y2="225" class="fisura-central-3d"/>
            <line x1="245" y1="175" x2="245" y2="225" class="fisura-central-3d"/>
            <line x1="260" y1="175" x2="260" y2="225" class="fisura-central-3d"/>
            <line x1="225" y1="190" x2="265" y2="190" class="fisura-secundaria-3d"/>
            <line x1="225" y1="210" x2="265" y2="210" class="fisura-secundaria-3d"/>
            <text x="245" y="200" class="numero-3d">17</text>
        </g>
        
        <!-- Diente 16 - Primer Molar Superior -->
        <g class="diente-3d molar-superior-3d" id="diente-16">
            <path d="M 290 185 Q 300 165 320 165 Q 340 165 350 185 Q 350 205 340 225 Q 320 230 300 225 Q 290 205 290 185 Z" class="superficie-3d"/>
            <path d="M 298 175 Q 305 170 313 175 Q 320 170 328 175 Q 335 170 342 175" class="cuspide-3d"/>
            <path d="M 298 195 Q 305 190 313 195 Q 320 190 328 195 Q 335 190 342 195" class="cuspide-3d"/>
            <path d="M 298 215 Q 305 210 313 215 Q 320 210 328 215 Q 335 210 342 215" class="cuspide-3d"/>
            <line x1="305" y1="170" x2="305" y2="220" class="fisura-central-3d"/>
            <line x1="320" y1="170" x2="320" y2="220" class="fisura-central-3d"/>
            <line x1="335" y1="170" x2="335" y2="220" class="fisura-central-3d"/>
            <line x1="300" y1="185" x2="340" y2="185" class="fisura-secundaria-3d"/>
            <line x1="300" y1="205" x2="340" y2="205" class="fisura-secundaria-3d"/>
            <text x="320" y="195" class="numero-3d">16</text>
        </g>
        
        <!-- Diente 15 - Segundo Premolar Superior -->
        <g class="diente-3d premolar-superior-3d" id="diente-15">
            <ellipse cx="375" cy="180" rx="16" ry="12" class="superficie-3d"/>
            <path d="M 363 170 Q 375 165 387 170" class="cuspide-3d"/>
            <path d="M 363 190 Q 375 195 387 190" class="cuspide-3d"/>
            <line x1="375" y1="168" x2="375" y2="192" class="fisura-central-3d"/>
            <line x1="368" y1="180" x2="382" y2="180" class="fisura-secundaria-3d"/>
            <text x="375" y="180" class="numero-3d">15</text>
        </g>
        
        <!-- Diente 14 - Primer Premolar Superior -->
        <g class="diente-3d premolar-superior-3d" id="diente-14">
            <ellipse cx="410" cy="175" rx="15" ry="11" class="superficie-3d"/>
            <path d="M 399 165 Q 410 160 421 165" class="cuspide-3d"/>
            <path d="M 399 185 Q 410 190 421 185" class="cuspide-3d"/>
            <line x1="410" y1="163" x2="410" y2="187" class="fisura-central-3d"/>
            <line x1="404" y1="175" x2="416" y2="175" class="fisura-secundaria-3d"/>
            <text x="410" y="175" class="numero-3d">14</text>
        </g>
        
        <!-- Diente 13 - Canino Superior -->
        <g class="diente-3d canino-superior-3d" id="diente-13">
            <path d="M 440 175 Q 450 155 460 175 Q 458 195 450 200 Q 442 195 440 175 Z" class="superficie-3d"/>
            <path d="M 446 170 Q 450 160 454 170" class="cuspide-3d"/>
            <line x1="450" y1="160" x2="450" y2="190" class="fisura-central-3d"/>
            <text x="450" y="180" class="numero-3d">13</text>
        </g>
        
        <!-- Diente 12 - Incisivo Lateral Superior -->
        <g class="diente-3d incisivo-lateral-superior-3d" id="diente-12">
            <rect x="475" y="170" width="18" height="14" rx="2" class="superficie-3d"/>
            <line x1="478" y1="177" x2="490" y2="177" class="fisura-secundaria-3d"/>
            <text x="484" y="177" class="numero-3d">12</text>
        </g>
        
        <!-- Diente 11 - Incisivo Central Superior -->
        <g class="diente-3d incisivo-central-superior-3d" id="diente-11">
            <rect x="508" y="167" width="20" height="16" rx="2" class="superficie-3d"/>
            <line x1="512" y1="175" x2="524" y2="175" class="fisura-secundaria-3d"/>
            <text x="518" y="175" class="numero-3d">11</text>
        </g>
        
        <!-- CUADRANTE SUPERIOR IZQUIERDO (21-28) -->
        
        <!-- Diente 21 - Incisivo Central Superior -->
        <g class="diente-3d incisivo-central-superior-3d" id="diente-21">
            <rect x="672" y="167" width="20" height="16" rx="2" class="superficie-3d"/>
            <line x1="676" y1="175" x2="688" y2="175" class="fisura-secundaria-3d"/>
            <text x="682" y="175" class="numero-3d">21</text>
        </g>
        
        <!-- Diente 22 - Incisivo Lateral Superior -->
        <g class="diente-3d incisivo-lateral-superior-3d" id="diente-22">
            <rect x="707" y="170" width="18" height="14" rx="2" class="superficie-3d"/>
            <line x1="710" y1="177" x2="722" y2="177" class="fisura-secundaria-3d"/>
            <text x="716" y="177" class="numero-3d">22</text>
        </g>
        
        <!-- Diente 23 - Canino Superior -->
        <g class="diente-3d canino-superior-3d" id="diente-23">
            <path d="M 740 175 Q 750 155 760 175 Q 758 195 750 200 Q 742 195 740 175 Z" class="superficie-3d"/>
            <path d="M 746 170 Q 750 160 754 170" class="cuspide-3d"/>
            <line x1="750" y1="160" x2="750" y2="190" class="fisura-central-3d"/>
            <text x="750" y="180" class="numero-3d">23</text>
        </g>
        
        <!-- Diente 24 - Primer Premolar Superior -->
        <g class="diente-3d premolar-superior-3d" id="diente-24">
            <ellipse cx="790" cy="175" rx="15" ry="11" class="superficie-3d"/>
            <path d="M 779 165 Q 790 160 801 165" class="cuspide-3d"/>
            <path d="M 779 185 Q 790 190 801 185" class="cuspide-3d"/>
            <line x1="790" y1="163" x2="790" y2="187" class="fisura-central-3d"/>
            <line x1="784" y1="175" x2="796" y2="175" class="fisura-secundaria-3d"/>
            <text x="790" y="175" class="numero-3d">24</text>
        </g>
        
        <!-- Diente 25 - Segundo Premolar Superior -->
        <g class="diente-3d premolar-superior-3d" id="diente-25">
            <ellipse cx="825" cy="180" rx="16" ry="12" class="superficie-3d"/>
            <path d="M 813 170 Q 825 165 837 170" class="cuspide-3d"/>
            <path d="M 813 190 Q 825 195 837 190" class="cuspide-3d"/>
            <line x1="825" y1="168" x2="825" y2="192" class="fisura-central-3d"/>
            <line x1="818" y1="180" x2="832" y2="180" class="fisura-secundaria-3d"/>
            <text x="825" y="180" class="numero-3d">25</text>
        </g>
        
        <!-- Diente 26 - Primer Molar Superior -->
        <g class="diente-3d molar-superior-3d" id="diente-26">
            <path d="M 850 185 Q 860 165 880 165 Q 900 165 910 185 Q 910 205 900 225 Q 880 230 860 225 Q 850 205 850 185 Z" class="superficie-3d"/>
            <path d="M 858 175 Q 865 170 873 175 Q 880 170 888 175 Q 895 170 902 175" class="cuspide-3d"/>
            <path d="M 858 195 Q 865 190 873 195 Q 880 190 888 195 Q 895 190 902 195" class="cuspide-3d"/>
            <path d="M 858 215 Q 865 210 873 215 Q 880 210 888 215 Q 895 210 902 215" class="cuspide-3d"/>
            <line x1="865" y1="170" x2="865" y2="220" class="fisura-central-3d"/>
            <line x1="880" y1="170" x2="880" y2="220" class="fisura-central-3d"/>
            <line x1="895" y1="170" x2="895" y2="220" class="fisura-central-3d"/>
            <line x1="860" y1="185" x2="900" y2="185" class="fisura-secundaria-3d"/>
            <line x1="860" y1="205" x2="900" y2="205" class="fisura-secundaria-3d"/>
            <text x="880" y="195" class="numero-3d">26</text>
        </g>
        
        <!-- Diente 27 - Segundo Molar Superior -->
        <g class="diente-3d molar-superior-3d" id="diente-27">
            <path d="M 925 190 Q 935 170 955 170 Q 975 170 985 190 Q 985 210 975 230 Q 955 235 935 230 Q 925 210 925 190 Z" class="superficie-3d"/>
            <path d="M 933 180 Q 940 175 948 180 Q 955 175 963 180 Q 970 175 977 180" class="cuspide-3d"/>
            <path d="M 933 200 Q 940 195 948 200 Q 955 195 963 200 Q 970 195 977 200" class="cuspide-3d"/>
            <path d="M 933 220 Q 940 215 948 220 Q 955 215 963 220 Q 970 215 977 220" class="cuspide-3d"/>
            <line x1="940" y1="175" x2="940" y2="225" class="fisura-central-3d"/>
            <line x1="955" y1="175" x2="955" y2="225" class="fisura-central-3d"/>
            <line x1="970" y1="175" x2="970" y2="225" class="fisura-central-3d"/>
            <line x1="935" y1="190" x2="975" y2="190" class="fisura-secundaria-3d"/>
            <line x1="935" y1="210" x2="975" y2="210" class="fisura-secundaria-3d"/>
            <text x="955" y="200" class="numero-3d">27</text>
        </g>
        
        <!-- Diente 28 - Tercer Molar Superior -->
        <g class="diente-3d molar-superior-3d" id="diente-28">
            <path d="M 1000 200 Q 1010 180 1030 180 Q 1050 180 1060 200 Q 1060 220 1050 240 Q 1030 245 1010 240 Q 1000 220 1000 200 Z" class="superficie-3d"/>
            <path d="M 1008 190 Q 1015 185 1023 190 Q 1030 185 1038 190 Q 1045 185 1052 190" class="cuspide-3d"/>
            <path d="M 1008 210 Q 1015 205 1023 210 Q 1030 205 1038 210 Q 1045 205 1052 210" class="cuspide-3d"/>
            <path d="M 1008 230 Q 1015 225 1023 230 Q 1030 225 1038 230 Q 1045 225 1052 230" class="cuspide-3d"/>
            <line x1="1015" y1="185" x2="1015" y2="235" class="fisura-central-3d"/>
            <line x1="1030" y1="185" x2="1030" y2="235" class="fisura-central-3d"/>
            <line x1="1045" y1="185" x2="1045" y2="235" class="fisura-central-3d"/>
            <line x1="1010" y1="200" x2="1050" y2="200" class="fisura-secundaria-3d"/>
            <line x1="1010" y1="220" x2="1050" y2="220" class="fisura-secundaria-3d"/>
            <text x="1030" y="215" class="numero-3d">28</text>
        </g>
        
        <!-- ==================== DIENTES INFERIORES 3D (ARCADA MS PEQUEA) ==================== -->
        
        <!-- CUADRANTE INFERIOR DERECHO (48-41) -->
        
        <!-- Diente 48 - Tercer Molar Inferior -->
        <g class="diente-3d molar-inferior-3d" id="diente-48">
            <path d="M 200 560 Q 210 540 230 540 Q 250 540 260 560 Q 260 580 250 600 Q 230 605 210 600 Q 200 580 200 560 Z" class="superficie-3d"/>
            <path d="M 208 550 Q 215 545 223 550 Q 230 545 238 550 Q 245 545 252 550" class="cuspide-3d"/>
            <path d="M 208 570 Q 215 565 223 570 Q 230 565 238 570 Q 245 565 252 570" class="cuspide-3d"/>
            <path d="M 208 590 Q 215 585 223 590 Q 230 585 238 590 Q 245 585 252 590" class="cuspide-3d"/>
            <line x1="215" y1="545" x2="215" y2="595" class="fisura-central-3d"/>
            <line x1="230" y1="545" x2="230" y2="595" class="fisura-central-3d"/>
            <line x1="245" y1="545" x2="245" y2="595" class="fisura-central-3d"/>
            <line x1="210" y1="560" x2="250" y2="560" class="fisura-secundaria-3d"/>
            <line x1="210" y1="580" x2="250" y2="580" class="fisura-secundaria-3d"/>
            <text x="230" y="575" class="numero-3d">48</text>
        </g>
        
        <!-- Diente 47 - Segundo Molar Inferior -->
        <g class="diente-3d molar-inferior-3d" id="diente-47">
            <path d="M 275 550 Q 285 530 305 530 Q 325 530 335 550 Q 335 570 325 590 Q 305 595 285 590 Q 275 570 275 550 Z" class="superficie-3d"/>
            <path d="M 283 540 Q 290 535 298 540 Q 305 535 313 540 Q 320 535 327 540" class="cuspide-3d"/>
            <path d="M 283 560 Q 290 555 298 560 Q 305 555 313 560 Q 320 555 327 560" class="cuspide-3d"/>
            <path d="M 283 580 Q 290 575 298 580 Q 305 575 313 580 Q 320 575 327 580" class="cuspide-3d"/>
            <line x1="290" y1="535" x2="290" y2="585" class="fisura-central-3d"/>
            <line x1="305" y1="535" x2="305" y2="585" class="fisura-central-3d"/>
            <line x1="320" y1="535" x2="320" y2="585" class="fisura-central-3d"/>
            <line x1="285" y1="550" x2="325" y2="550" class="fisura-secundaria-3d"/>
            <line x1="285" y1="570" x2="325" y2="570" class="fisura-secundaria-3d"/>
            <text x="305" y="565" class="numero-3d">47</text>
        </g>
        
        <!-- Diente 46 - Primer Molar Inferior -->
        <g class="diente-3d molar-inferior-3d" id="diente-46">
            <path d="M 350 545 Q 360 525 380 525 Q 400 525 410 545 Q 410 565 400 585 Q 380 590 360 585 Q 350 565 350 545 Z" class="superficie-3d"/>
            <path d="M 358 535 Q 365 530 373 535 Q 380 530 388 535 Q 395 530 402 535" class="cuspide-3d"/>
            <path d="M 358 555 Q 365 550 373 555 Q 380 550 388 555 Q 395 550 402 555" class="cuspide-3d"/>
            <path d="M 358 575 Q 365 570 373 575 Q 380 570 388 575 Q 395 570 402 575" class="cuspide-3d"/>
            <line x1="365" y1="530" x2="365" y2="580" class="fisura-central-3d"/>
            <line x1="380" y1="530" x2="380" y2="580" class="fisura-central-3d"/>
            <line x1="395" y1="530" x2="395" y2="580" class="fisura-central-3d"/>
            <line x1="360" y1="545" x2="400" y2="545" class="fisura-secundaria-3d"/>
            <line x1="360" y1="565" x2="400" y2="565" class="fisura-secundaria-3d"/>
            <text x="380" y="560" class="numero-3d">46</text>
        </g>
        
        <!-- Diente 45 - Segundo Premolar Inferior -->
        <g class="diente-3d premolar-inferior-3d" id="diente-45">
            <ellipse cx="435" cy="540" rx="16" ry="12" class="superficie-3d"/>
            <path d="M 423 530 Q 435 525 447 530" class="cuspide-3d"/>
            <path d="M 423 550 Q 435 555 447 550" class="cuspide-3d"/>
            <line x1="435" y1="528" x2="435" y2="552" class="fisura-central-3d"/>
            <line x1="428" y1="540" x2="442" y2="540" class="fisura-secundaria-3d"/>
            <text x="435" y="540" class="numero-3d">45</text>
        </g>
        
        <!-- Diente 44 - Primer Premolar Inferior -->
        <g class="diente-3d premolar-inferior-3d" id="diente-44">
            <ellipse cx="470" cy="535" rx="15" ry="11" class="superficie-3d"/>
            <path d="M 459 525 Q 470 520 481 525" class="cuspide-3d"/>
            <path d="M 459 545 Q 470 550 481 545" class="cuspide-3d"/>
            <line x1="470" y1="523" x2="470" y2="547" class="fisura-central-3d"/>
            <line x1="464" y1="535" x2="476" y2="535" class="fisura-secundaria-3d"/>
            <text x="470" y="535" class="numero-3d">44</text>
        </g>
        
        <!-- Diente 43 - Canino Inferior -->
        <g class="diente-3d canino-inferior-3d" id="diente-43">
            <path d="M 500 535 Q 510 515 520 535 Q 518 555 510 560 Q 502 555 500 535 Z" class="superficie-3d"/>
            <path d="M 506 530 Q 510 520 514 530" class="cuspide-3d"/>
            <line x1="510" y1="520" x2="510" y2="550" class="fisura-central-3d"/>
            <text x="510" y="540" class="numero-3d">43</text>
        </g>
        
        <!-- Diente 42 - Incisivo Lateral Inferior -->
        <g class="diente-3d incisivo-lateral-inferior-3d" id="diente-42">
            <rect x="535" y="530" width="16" height="12" rx="2" class="superficie-3d"/>
            <line x1="538" y1="536" x2="548" y2="536" class="fisura-secundaria-3d"/>
            <text x="543" y="536" class="numero-3d">42</text>
        </g>
        
        <!-- Diente 41 - Incisivo Central Inferior -->
        <g class="diente-3d incisivo-central-inferior-3d" id="diente-41">
            <rect x="565" y="527" width="18" height="14" rx="2" class="superficie-3d"/>
            <line x1="568" y1="534" x2="580" y2="534" class="fisura-secundaria-3d"/>
            <text x="574" y="534" class="numero-3d">41</text>
        </g>
        
        <!-- CUADRANTE INFERIOR IZQUIERDO (31-38) -->
        
        <!-- Diente 31 - Incisivo Central Inferior -->
        <g class="diente-3d incisivo-central-inferior-3d" id="diente-31">
            <rect x="617" y="527" width="18" height="14" rx="2" class="superficie-3d"/>
            <line x1="620" y1="534" x2="632" y2="534" class="fisura-secundaria-3d"/>
            <text x="626" y="534" class="numero-3d">31</text>
        </g>
        
        <!-- Diente 32 - Incisivo Lateral Inferior -->
        <g class="diente-3d incisivo-lateral-inferior-3d" id="diente-32">
            <rect x="649" y="530" width="16" height="12" rx="2" class="superficie-3d"/>
            <line x1="652" y1="536" x2="662" y2="536" class="fisura-secundaria-3d"/>
            <text x="657" y="536" class="numero-3d">32</text>
        </g>
        
        <!-- Diente 33 - Canino Inferior -->
        <g class="diente-3d canino-inferior-3d" id="diente-33">
            <path d="M 680 535 Q 690 515 700 535 Q 698 555 690 560 Q 682 555 680 535 Z" class="superficie-3d"/>
            <path d="M 686 530 Q 690 520 694 530" class="cuspide-3d"/>
            <line x1="690" y1="520" x2="690" y2="550" class="fisura-central-3d"/>
            <text x="690" y="540" class="numero-3d">33</text>
        </g>
        
        <!-- Diente 34 - Primer Premolar Inferior -->
        <g class="diente-3d premolar-inferior-3d" id="diente-34">
            <ellipse cx="730" cy="535" rx="15" ry="11" class="superficie-3d"/>
            <path d="M 719 525 Q 730 520 741 525" class="cuspide-3d"/>
            <path d="M 719 545 Q 730 550 741 545" class="cuspide-3d"/>
            <line x1="730" y1="523" x2="730" y2="547" class="fisura-central-3d"/>
            <line x1="724" y1="535" x2="736" y2="535" class="fisura-secundaria-3d"/>
            <text x="730" y="535" class="numero-3d">34</text>
        </g>
        
        <!-- Diente 35 - Segundo Premolar Inferior -->
        <g class="diente-3d premolar-inferior-3d" id="diente-35">
            <ellipse cx="765" cy="540" rx="16" ry="12" class="superficie-3d"/>
            <path d="M 753 530 Q 765 525 777 530" class="cuspide-3d"/>
            <path d="M 753 550 Q 765 555 777 550" class="cuspide-3d"/>
            <line x1="765" y1="528" x2="765" y2="552" class="fisura-central-3d"/>
            <line x1="758" y1="540" x2="772" y2="540" class="fisura-secundaria-3d"/>
            <text x="765" y="540" class="numero-3d">35</text>
        </g>
        
        <!-- Diente 36 - Primer Molar Inferior -->
        <g class="diente-3d molar-inferior-3d" id="diente-36">
            <path d="M 790 545 Q 800 525 820 525 Q 840 525 850 545 Q 850 565 840 585 Q 820 590 800 585 Q 790 565 790 545 Z" class="superficie-3d"/>
            <path d="M 798 535 Q 805 530 813 535 Q 820 530 828 535 Q 835 530 842 535" class="cuspide-3d"/>
            <path d="M 798 555 Q 805 550 813 555 Q 820 550 828 555 Q 835 550 842 555" class="cuspide-3d"/>
            <path d="M 798 575 Q 805 570 813 575 Q 820 570 828 575 Q 835 570 842 575" class="cuspide-3d"/>
            <line x1="805" y1="530" x2="805" y2="580" class="fisura-central-3d"/>
            <line x1="820" y1="530" x2="820" y2="580" class="fisura-central-3d"/>
            <line x1="835" y1="530" x2="835" y2="580" class="fisura-central-3d"/>
            <line x1="800" y1="545" x2="840" y2="545" class="fisura-secundaria-3d"/>
            <line x1="800" y1="565" x2="840" y2="565" class="fisura-secundaria-3d"/>
            <text x="820" y="560" class="numero-3d">36</text>
        </g>
        
        <!-- Diente 37 - Segundo Molar Inferior -->
        <g class="diente-3d molar-inferior-3d" id="diente-37">
            <path d="M 865 550 Q 875 530 895 530 Q 915 530 925 550 Q 925 570 915 590 Q 895 595 875 590 Q 865 570 865 550 Z" class="superficie-3d"/>
            <path d="M 873 540 Q 880 535 888 540 Q 895 535 903 540 Q 910 535 917 540" class="cuspide-3d"/>
            <path d="M 873 560 Q 880 555 888 560 Q 895 555 903 560 Q 910 555 917 560" class="cuspide-3d"/>
            <path d="M 873 580 Q 880 575 888 580 Q 895 575 903 580 Q 910 575 917 580" class="cuspide-3d"/>
            <line x1="880" y1="535" x2="880" y2="585" class="fisura-central-3d"/>
            <line x1="895" y1="535" x2="895" y2="585" class="fisura-central-3d"/>
            <line x1="910" y1="535" x2="910" y2="585" class="fisura-central-3d"/>
            <line x1="875" y1="550" x2="915" y2="550" class="fisura-secundaria-3d"/>
            <line x1="875" y1="570" x2="915" y2="570" class="fisura-secundaria-3d"/>
            <text x="895" y="565" class="numero-3d">37</text>
        </g>
        
        <!-- Diente 38 - Tercer Molar Inferior -->
        <g class="diente-3d molar-inferior-3d" id="diente-38">
            <path d="M 940 560 Q 950 540 970 540 Q 990 540 1000 560 Q 1000 580 990 600 Q 970 605 950 600 Q 940 580 940 560 Z" class="superficie-3d"/>
            <path d="M 948 550 Q 955 545 963 550 Q 970 545 978 550 Q 985 545 992 550" class="cuspide-3d"/>
            <path d="M 948 570 Q 955 565 963 570 Q 970 565 978 570 Q 985 565 992 570" class="cuspide-3d"/>
            <path d="M 948 590 Q 955 585 963 590 Q 970 585 978 590 Q 985 585 992 590" class="cuspide-3d"/>
            <line x1="955" y1="545" x2="955" y2="595" class="fisura-central-3d"/>
            <line x1="970" y1="545" x2="970" y2="595" class="fisura-central-3d"/>
            <line x1="985" y1="545" x2="985" y2="595" class="fisura-central-3d"/>
            <line x1="950" y1="560" x2="990" y2="560" class="fisura-secundaria-3d"/>
            <line x1="950" y1="580" x2="990" y2="580" class="fisura-secundaria-3d"/>
            <text x="970" y="575" class="numero-3d">38</text>
        </g>
        
    </svg>
</div>

<script>
(function() {
    'use strict';
    
    function log(mensaje) {
        console.log(`[ODONTOGRAMA 3D REALISTA] ${mensaje}`);
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        log('Iniciando odontograma 3D ultra realista');
        
        const dientes = document.querySelectorAll('.diente-3d');
        log(`Configurando ${dientes.length} dientes con anatom铆a 3D realista`);
        
        dientes.forEach(function(diente, index) {
            const dienteId = diente.id;
            const numeroFDI = dienteId.replace('diente-', '');
            const cuadrante = Math.floor(numeroFDI / 10);
            const posicion = numeroFDI % 10;
            
            // Determinar el tipo de diente con clasificaci贸n anat贸mica exacta
            let tipoDiente = '';
            let tipoAnatomico3D = '';
            if (posicion === 1) {
                tipoDiente = 'Incisivo Central';
                tipoAnatomico3D = cuadrante <= 2 ? 'incisivo-central-superior-3d' : 'incisivo-central-inferior-3d';
            } else if (posicion === 2) {
                tipoDiente = 'Incisivo Lateral';
                tipoAnatomico3D = cuadrante <= 2 ? 'incisivo-lateral-superior-3d' : 'incisivo-lateral-inferior-3d';
            } else if (posicion === 3) {
                tipoDiente = 'Canino';
                tipoAnatomico3D = cuadrante <= 2 ? 'canino-superior-3d' : 'canino-inferior-3d';
            } else if (posicion === 4) {
                tipoDiente = 'Primer Premolar';
                tipoAnatomico3D = cuadrante <= 2 ? 'premolar-superior-3d' : 'premolar-inferior-3d';
            } else if (posicion === 5) {
                tipoDiente = 'Segundo Premolar';
                tipoAnatomico3D = cuadrante <= 2 ? 'premolar-superior-3d' : 'premolar-inferior-3d';
            } else if (posicion === 6) {
                tipoDiente = 'Primer Molar';
                tipoAnatomico3D = cuadrante <= 2 ? 'molar-superior-3d' : 'molar-inferior-3d';
            } else if (posicion === 7) {
                tipoDiente = 'Segundo Molar';
                tipoAnatomico3D = cuadrante <= 2 ? 'molar-superior-3d' : 'molar-inferior-3d';
            } else if (posicion === 8) {
                tipoDiente = 'Tercer Molar';
                tipoAnatomico3D = cuadrante <= 2 ? 'molar-superior-3d' : 'molar-inferior-3d';
            }
            
            diente.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                log(`Diente 3D realista seleccionado: FDI ${numeroFDI} (${tipoDiente}, ${tipoAnatomico3D})`);
                
                // Remover selecci贸n anterior
                document.querySelectorAll('.diente-3d').forEach(d => {
                    d.classList.remove('selected');
                });
                
                // Seleccionar diente actual
                diente.classList.add('selected');
                
                // Disparar evento personalizado
                const eventoSeleccion = new CustomEvent('diente3DRealistaSeleccionado', {
                    detail: {
                        numeroFDI: numeroFDI,
                        cuadrante: cuadrante,
                        posicion: posicion,
                        tipoDiente: tipoDiente,
                        tipoAnatomico3D: tipoAnatomico3D,
                        elemento: diente
                    }
                });
                
                document.dispatchEvent(eventoSeleccion);
            });
            
            diente.addEventListener('mouseenter', function() {
                log(`Vista 3D: Diente FDI ${numeroFDI} (${tipoDiente}) - Anatom铆a ${tipoAnatomico3D}`);
            });
        });
        
        log('Odontograma 3D realista inicializado correctamente');
    });
    
    // Funci贸n global para aplicar diagn贸sticos
    window.aplicarDiagnostico3D = function(numeroFDI, diagnostico) {
        const diente = document.getElementById(`diente-${numeroFDI}`);
        if (diente) {
            // Remover diagn贸sticos anteriores
            diente.classList.remove('sano', 'caries', 'obturada', 'corona', 'extraida', 'implante', 'endodoncia');
            
            // Aplicar nuevo diagn贸stico
            if (diagnostico) {
                diente.classList.add(diagnostico);
                log(`Diagn贸stico 3D aplicado: Diente ${numeroFDI} - ${diagnostico}`);
            }
        }
    };
    
    // Funci贸n global para limpiar selecciones
    window.limpiarSeleccion3D = function() {
        document.querySelectorAll('.diente-3d').forEach(diente => {
            diente.classList.remove('selected', 'sano', 'caries', 'obturada', 'corona', 'extraida', 'implante', 'endodoncia');
        });
        log('Selecci贸n 3D y diagn贸sticos limpiados');
    };
    
})();
</script>