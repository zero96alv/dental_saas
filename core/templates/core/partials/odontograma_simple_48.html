{% load math_filters %}
<div id="odontograma-simple-container" class="odontograma-simple">
    <!-- SVG Principal - Funcional y Simple -->
    <svg id="odontograma-simple-svg" 
         class="odontograma-funcional" 
         viewBox="0 0 1000 500" 
         xmlns="http://www.w3.org/2000/svg"
         preserveAspectRatio="xMidYMid meet">
        
        <!-- Estilos CSS integrados -->
        <defs>
            <style>
                /* Estilos para dientes simples y funcionales */
                .diente-simple {
                    cursor: pointer;
                    transition: filter 0.2s ease;
                }
                
                .diente-simple:hover {
                    filter: brightness(1.1) drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
                }
                
                .diente-simple.seleccionado {
                    filter: brightness(1.2) drop-shadow(3px 3px 6px rgba(0,123,255,0.6));
                }
                
                .diente-corona {
                    fill: #ffffff;
                    stroke: #888;
                    stroke-width: 2;
                }
                
                .numero-diente {
                    font-size: 14px;
                    font-weight: bold;
                    fill: #333;
                    text-anchor: middle;
                    pointer-events: none;
                    font-family: Arial, sans-serif;
                }
                
                /* Estados de diagnóstico */
                .sano .diente-corona { fill: #f0fff0; stroke: #4caf50; }
                .caries .diente-corona { fill: #ffebee; stroke: #f44336; }
                .obturada .diente-corona { fill: #fff8e1; stroke: #ffc107; }
                .corona .diente-corona { fill: #e3f2fd; stroke: #2196f3; }
                .extraida .diente-corona { 
                    fill: #fafafa; 
                    stroke: #9e9e9e; 
                    stroke-dasharray: 4,2; 
                    opacity: 0.6; 
                }
                .implante .diente-corona { 
                    fill: #eceff1; 
                    stroke: #607d8b; 
                    stroke-width: 3; 
                }
                
                /* Supernumerarios */
                .supernumerario .diente-corona {
                    stroke: #ff9800;
                    stroke-dasharray: 3,1;
                }
                
                .supernumerario .numero-diente {
                    fill: #ff9800;
                    font-size: 12px;
                }
            </style>
        </defs>

        <!-- Fondo -->
        <rect width="100%" height="100%" fill="#f8f9fa"/>
        
        <!-- Líneas de referencia -->
        <line x1="500" y1="50" x2="500" y2="450" stroke="#e0e0e0" stroke-width="1"/>
        <line x1="100" y1="250" x2="900" y2="250" stroke="#e0e0e0" stroke-width="1"/>
        
        <!-- Etiquetas de cuadrantes -->
        <text x="300" y="80" font-size="24" font-weight="bold" fill="#bbb" text-anchor="middle">I</text>
        <text x="700" y="80" font-size="24" font-weight="bold" fill="#bbb" text-anchor="middle">II</text>
        <text x="300" y="430" font-size="24" font-weight="bold" fill="#bbb" text-anchor="middle">IV</text>
        <text x="700" y="430" font-size="24" font-weight="bold" fill="#bbb" text-anchor="middle">III</text>

        <!-- CUADRANTE I (Superior Derecho) - 12 dientes -->
        <g id="cuadrante-1">
            <!-- Supernumerario 19 -->
            <g class="diente-simple supernumerario" id="diente-19">
                <rect x="120" y="120" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="135" y="145">19</text>
            </g>
            
            <!-- Supernumerario 110 -->
            <g class="diente-simple supernumerario" id="diente-110">
                <rect x="160" y="130" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="172" y="151">110</text>
            </g>
            
            <!-- Tercer molar 18 -->
            <g class="diente-simple" id="diente-18">
                <rect x="200" y="140" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="217" y="168">18</text>
            </g>
            
            <!-- Segundo molar 17 -->
            <g class="diente-simple" id="diente-17">
                <rect x="245" y="145" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="262" y="173">17</text>
            </g>
            
            <!-- Primer molar 16 -->
            <g class="diente-simple" id="diente-16">
                <rect x="290" y="150" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="307" y="178">16</text>
            </g>
            
            <!-- Segundo premolar 15 -->
            <g class="diente-simple" id="diente-15">
                <rect x="335" y="155" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="350" y="180">15</text>
            </g>
            
            <!-- Primer premolar 14 -->
            <g class="diente-simple" id="diente-14">
                <rect x="375" y="160" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="390" y="185">14</text>
            </g>
            
            <!-- Canino 13 -->
            <g class="diente-simple" id="diente-13">
                <polygon points="415,165 435,165 430,210 420,210" class="diente-corona"/>
                <text class="numero-diente" x="425" y="192">13</text>
            </g>
            
            <!-- Incisivo lateral 12 -->
            <g class="diente-simple" id="diente-12">
                <rect x="445" y="170" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="457" y="192">12</text>
            </g>
            
            <!-- Incisivo central 11 -->
            <g class="diente-simple" id="diente-11">
                <rect x="480" y="175" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="492" y="197">11</text>
            </g>
        </g>

        <!-- CUADRANTE II (Superior Izquierdo) - 12 dientes -->
        <g id="cuadrante-2">
            <!-- Incisivo central 21 -->
            <g class="diente-simple" id="diente-21">
                <rect x="515" y="175" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="527" y="197">21</text>
            </g>
            
            <!-- Incisivo lateral 22 -->
            <g class="diente-simple" id="diente-22">
                <rect x="550" y="170" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="562" y="192">22</text>
            </g>
            
            <!-- Canino 23 -->
            <g class="diente-simple" id="diente-23">
                <polygon points="585,165 605,165 600,210 590,210" class="diente-corona"/>
                <text class="numero-diente" x="597" y="192">23</text>
            </g>
            
            <!-- Primer premolar 24 -->
            <g class="diente-simple" id="diente-24">
                <rect x="615" y="160" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="630" y="185">24</text>
            </g>
            
            <!-- Segundo premolar 25 -->
            <g class="diente-simple" id="diente-25">
                <rect x="655" y="155" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="670" y="180">25</text>
            </g>
            
            <!-- Primer molar 26 -->
            <g class="diente-simple" id="diente-26">
                <rect x="695" y="150" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="712" y="178">26</text>
            </g>
            
            <!-- Segundo molar 27 -->
            <g class="diente-simple" id="diente-27">
                <rect x="740" y="145" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="757" y="173">27</text>
            </g>
            
            <!-- Tercer molar 28 -->
            <g class="diente-simple" id="diente-28">
                <rect x="785" y="140" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="802" y="168">28</text>
            </g>
            
            <!-- Supernumerario 210 -->
            <g class="diente-simple supernumerario" id="diente-210">
                <rect x="830" y="130" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="842" y="151">210</text>
            </g>
            
            <!-- Supernumerario 29 -->
            <g class="diente-simple supernumerario" id="diente-29">
                <rect x="865" y="120" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="880" y="145">29</text>
            </g>
        </g>

        <!-- CUADRANTE III (Inferior Izquierdo) - 12 dientes -->
        <g id="cuadrante-3">
            <!-- Incisivo central 31 -->
            <g class="diente-simple" id="diente-31">
                <rect x="515" y="290" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="527" y="313">31</text>
            </g>
            
            <!-- Incisivo lateral 32 -->
            <g class="diente-simple" id="diente-32">
                <rect x="550" y="295" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="562" y="318">32</text>
            </g>
            
            <!-- Canino 33 -->
            <g class="diente-simple" id="diente-33">
                <polygon points="585,290 605,290 600,335 590,335" class="diente-corona"/>
                <text class="numero-diente" x="597" y="318">33</text>
            </g>
            
            <!-- Primer premolar 34 -->
            <g class="diente-simple" id="diente-34">
                <rect x="615" y="305" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="630" y="330">34</text>
            </g>
            
            <!-- Segundo premolar 35 -->
            <g class="diente-simple" id="diente-35">
                <rect x="655" y="310" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="670" y="335">35</text>
            </g>
            
            <!-- Primer molar 36 -->
            <g class="diente-simple" id="diente-36">
                <rect x="695" y="315" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="712" y="343">36</text>
            </g>
            
            <!-- Segundo molar 37 -->
            <g class="diente-simple" id="diente-37">
                <rect x="740" y="320" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="757" y="348">37</text>
            </g>
            
            <!-- Tercer molar 38 -->
            <g class="diente-simple" id="diente-38">
                <rect x="785" y="325" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="802" y="353">38</text>
            </g>
            
            <!-- Supernumerario 310 -->
            <g class="diente-simple supernumerario" id="diente-310">
                <rect x="830" y="335" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="842" y="358">310</text>
            </g>
            
            <!-- Supernumerario 39 -->
            <g class="diente-simple supernumerario" id="diente-39">
                <rect x="865" y="345" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="880" y="370">39</text>
            </g>
        </g>

        <!-- CUADRANTE IV (Inferior Derecho) - 12 dientes -->
        <g id="cuadrante-4">
            <!-- Supernumerario 49 -->
            <g class="diente-simple supernumerario" id="diente-49">
                <rect x="120" y="345" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="135" y="370">49</text>
            </g>
            
            <!-- Supernumerario 410 -->
            <g class="diente-simple supernumerario" id="diente-410">
                <rect x="160" y="335" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="172" y="358">410</text>
            </g>
            
            <!-- Tercer molar 48 -->
            <g class="diente-simple" id="diente-48">
                <rect x="200" y="325" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="217" y="353">48</text>
            </g>
            
            <!-- Segundo molar 47 -->
            <g class="diente-simple" id="diente-47">
                <rect x="245" y="320" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="262" y="348">47</text>
            </g>
            
            <!-- Primer molar 46 -->
            <g class="diente-simple" id="diente-46">
                <rect x="290" y="315" width="35" height="45" rx="6" class="diente-corona"/>
                <text class="numero-diente" x="307" y="343">46</text>
            </g>
            
            <!-- Segundo premolar 45 -->
            <g class="diente-simple" id="diente-45">
                <rect x="335" y="310" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="350" y="335">45</text>
            </g>
            
            <!-- Primer premolar 44 -->
            <g class="diente-simple" id="diente-44">
                <rect x="375" y="305" width="30" height="40" rx="5" class="diente-corona"/>
                <text class="numero-diente" x="390" y="330">44</text>
            </g>
            
            <!-- Canino 43 -->
            <g class="diente-simple" id="diente-43">
                <polygon points="415,290 435,290 430,335 420,335" class="diente-corona"/>
                <text class="numero-diente" x="425" y="318">43</text>
            </g>
            
            <!-- Incisivo lateral 42 -->
            <g class="diente-simple" id="diente-42">
                <rect x="445" y="295" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="457" y="318">42</text>
            </g>
            
            <!-- Incisivo central 41 -->
            <g class="diente-simple" id="diente-41">
                <rect x="480" y="290" width="25" height="35" rx="4" class="diente-corona"/>
                <text class="numero-diente" x="492" y="313">41</text>
            </g>
        </g>
        
        <!-- Información -->
        <text x="50" y="470" font-size="12" fill="#666">Odontograma de 48 Dientes - Click en un diente para seleccionar</text>
        <text x="50" y="485" font-size="10" fill="#999">Supernumerarios marcados con líneas punteadas</text>
    </svg>
</div>

<style>
.odontograma-simple {
    background: #ffffff;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.odontograma-funcional {
    width: 100%;
    height: auto;
    max-height: 80vh;
}

/* Responsividad */
@media (max-width: 768px) {
    .odontograma-funcional {
        max-height: 60vh;
    }
}

@media (max-width: 576px) {
    .odontograma-funcional {
        max-height: 50vh;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('Inicializando odontograma simple de 48 dientes');
    
    // Configurar eventos de clic para todos los dientes
    document.querySelectorAll('.diente-simple').forEach(function(diente) {
        diente.addEventListener('click', function() {
            // Remover selección anterior
            document.querySelectorAll('.diente-simple').forEach(function(d) {
                d.classList.remove('seleccionado');
            });
            
            // Seleccionar diente actual
            this.classList.add('seleccionado');
            
            const numeroDiente = this.id.replace('diente-', '');
            console.log('Diente seleccionado:', numeroDiente);
            
            // Disparar evento personalizado para integración con sistema principal
            const evento = new CustomEvent('dienteSeleccionadoSimple', {
                detail: {
                    numeroDiente: numeroDiente,
                    elemento: this
                }
            });
            
            document.dispatchEvent(evento);
        });
    });
    
    console.log('Odontograma simple inicializado - 48 dientes disponibles');
});
</script>